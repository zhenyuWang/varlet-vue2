import{I as m}from"./index.066dff7a.js";import{d as _}from"./create.242e0646.js";import{c as p,f as v}from"./elements.9c883ade.js";import{t as a}from"./shared.f8da68a0.js";import{n as d}from"./index.31927c0d.js";import{C as S}from"./index.e0b37af0.js";import{d as y}from"./index.9b1139e6.js";import{a as g}from"./utils.3b864b4e.js";import"./vendor.4f0eb98f.js";const b={value:{type:Boolean},disabled:{type:Boolean,default:!1},animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:{type:String},successBgColor:{type:String},color:{type:String},successColor:{type:String}};var C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"freshNode",staticClass:"var-pull-refresh",on:{touchstart:e.touchStart,touchmove:e.touchMove,touchend:e.touchEnd,touchcancel:e.touchEnd}},[s("div",{staticClass:"var-pull-refresh__control var-elevation--2",class:[e.isSuccess?"var-pull-refresh__control-success":null],style:e.controlStyle},[s("var-icon",{class:e.iconClass,attrs:{name:e.iconName,transition:200,"var-pull-refresh-cover":""}})],1),e._t("default")],2)},E=[];const o=100,n=-50;let c;const N=_({name:"VarPullRefresh",components:{VarIcon:m},props:b,data:()=>({freshNode:null,startPosition:0,distance:n,iconName:"arrow-down",refreshStatus:"default",isEnd:!1}),computed:{isTouchable(){return this.refreshStatus!=="loading"&&this.refreshStatus!=="success"&&!this.disabled},iconClass(){return{"var-pull-refresh__icon":!0,"var-pull-refresh__animation":this.refreshStatus==="loading"}},controlStyle(){return{transform:`translate3d(0px, ${this.distance}px, 0px) translate(-50%, 0)`,transition:this.isEnd?`transform ${this.animationDuration}ms`:void 0,background:this.successBgColor||this.bgColor,color:this.successColor||this.color}},isSuccess(){return this.refreshStatus==="success"}},mounted(){c=p(this.freshNode)},watch:{value(e){e===!1&&(this.isEnd=!0,this.refreshStatus="success",this.iconName="checkbox-marked-circle",setTimeout(()=>{this.distance=n,this.reset()},a(this.successDuration)))}},methods:{touchStart(e){!this.isTouchable||(this.refreshStatus="pulling",this.startPosition=e.touches[0].clientY)},touchMove(e){const t=v(c);if(t>0||!this.isTouchable)return;t===0&&this.distance>n&&e.cancelable&&e.preventDefault();const s=(e.touches[0].clientY-this.startPosition)/2+n;this.distance=s>=o?o:s,this.iconName=this.distance>=o*.2?"refresh":"arrow-down"},touchEnd(){var e,t,s,r;!this.isTouchable||(this.isEnd=!0,this.distance>=o*.2?(this.refreshStatus="loading",this.distance=o*.3,(t=(e=this.getListeners()).onInput)==null||t.call(e,!0),(r=(s=this.getListeners()).onRefresh)==null||r.call(s)):(this.refreshStatus="loosing",this.iconName="arrow-down",this.distance=n,setTimeout(()=>{this.isEnd=!1},a(this.animationDuration))))},reset(){setTimeout(()=>{this.refreshStatus="default",this.iconName="arrow-down",this.isEnd=!1},a(this.animationDuration))}}}),u={};var x=d(N,C,E,!1,R,null,null,null);function R(e){for(let t in u)this[t]=u[t]}var i=function(){return x.exports}();i.install=function(e){e.component(i.name,i)};var T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("var-pull-refresh",{attrs:{"success-duration":"2000"},on:{refresh:e.refresh},model:{value:e.isRefresh,callback:function(r){e.isRefresh=r},expression:"isRefresh"}},e._l(e.data,function(r,l){return s("var-cell",{key:l,attrs:{border:""}},[e._v(e._s(r+" "+(l+1)))])}),1)},w=[];const h=Array(10).fill("List Item"),D=Array(10).fill("This is new List Item"),I={name:"PullRefreshExample",components:{VarPullRefresh:i,VarCell:S},data:()=>({isRefresh:!1,data:h}),created(){g(this,y)},mounted(){document.body.addEventListener("touchmove",this.prevent,{passive:!1})},beforeDestroy(){document.body.removeEventListener("touchmove",this.prevent)},methods:{refresh(){window.setTimeout(()=>{this.data=this.data[0]==="List Item"?D:h,this.isRefresh=!1},2e3)},prevent(e){e.preventDefault()}}},f={};var P=d(I,T,w,!1,$,"1afb730e",null,null);function $(e){for(let t in f)this[t]=f[t]}var Y=function(){return P.exports}();export{Y as default};
