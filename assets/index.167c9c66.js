import{d as l,n as h}from"./create.242e0646.js";import"./index.e6a3085a.js";import{t as n,g as f,a as o}from"./elements.9c883ade.js";import{c}from"./zIndex.8f867e84.js";import{c as m}from"./teleport.cb83deae.js";import{N as r}from"./shared.f8da68a0.js";import"./index.8d5eec0c.js";import{T as d}from"./Teleport.67437bea.js";function p(t){return["top","bottom"].includes(t)}const u={show:{type:Boolean,default:!1},alignment:{type:String,default:"top",validator:p},offsetX:{type:[Number,String],default:0},offsetY:{type:[Number,String],default:0},teleport:{type:String,default:"body"}};var s=l({name:"VarMenu",mixins:[c("show",1),m],props:u,data:()=>({to:null,top:0,left:0,clickSelf:!1}),computed:{transitionStyle(){return{top:`calc(${this.top}px + ${n(this.offsetY)})`,left:`calc(${this.left}px + ${n(this.offsetX)})`,zIndex:this.zIndex}}},mounted(){this.to=this.teleport,this.resize(),document.addEventListener("click",this.handleMenuClose),window.addEventListener("resize",this.resize)},beforeDestroy(){document.removeEventListener("click",this.handleMenuClose),window.removeEventListener("resize",this.resize)},watch:{alignment(){this.resize()},async show(t){const{onOpen:e,onClose:i}=this.getListeners();t&&(await h(),this.resize()),t?e==null||e():i==null||i()},teleport(t){this.to=t}},methods:{resize(){const{host:t}=this.$refs;this.top=this.computeTop(this.alignment),!!t&&(this.left=f(t))},computeTop(t){const{host:e,menu:i}=this.$refs;if(!!e)return t==="top"?o(e):o(e)-i.offsetHeight},handleClick(){this.clickSelf=!0},handleMenuClose(){var t,e;if(this.clickSelf){this.clickSelf=!1;return}!this.show||(e=(t=this.getListeners())["onUpdate:show"])==null||e.call(t)},renderTransition(){var e,i;const t=this.$createElement;return t("transition",{attrs:{name:"var-menu"},on:{afterEnter:(e=this.getListeners().onOpened)!=null?e:r,afterLeave:(i=this.getListeners().onClosed)!=null?i:r}},[t("div",{class:"var-menu__menu var-elevation--3",ref:"menu",style:this.transitionStyle,directives:[{name:"show",value:this.show}],on:{click:a=>{a.stopPropagation()}}},[this.slots("menu")])])}},render(){const t=arguments[0];return t("div",{class:"var-menu",ref:"host",on:{click:this.handleClick}},[this.slots("default"),this.to?t(d,{attrs:{to:this.to,disabled:this.teleportDisabled}},[this.renderTransition()]):this.renderTransition()])}});s.install=function(t){t.component(s.name,s)};export{s as M};
